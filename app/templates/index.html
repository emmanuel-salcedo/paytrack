{% extends "base.html" %}

{% block title %}PayTrack | Dashboard{% endblock %}

{% block content %}
<section class="hero">
  <span class="pill">Dashboard</span>
  <h1>Current Cycle Overview</h1>
  <p class="muted">Track what is due right now and take actions quickly.</p>
</section>

<section class="stat-grid" aria-label="Dashboard summary">
  <article class="card stat-card stat-card-primary">
    <p class="eyebrow">Current Cycle</p>
    <h2>{{ current_cycle_snapshot.cycle_start }} to {{ current_cycle_snapshot.cycle_end }}</h2>
    <p class="big-amount">${{ '%.2f'|format(current_cycle_snapshot.remaining_total) }}</p>
    <p class="muted">Remaining this cycle</p>
    <div class="mini-rows">
      <div><span>Scheduled</span><strong>${{ '%.2f'|format(current_cycle_snapshot.scheduled_total) }}</strong></div>
      <div><span>Paid</span><strong>${{ '%.2f'|format(current_cycle_snapshot.paid_total) }}</strong></div>
    </div>
  </article>

  <article class="card stat-card">
    <p class="eyebrow">Current Cycle Totals</p>
    <h2>Cash Flow vs Obligations</h2>
    <p class="big-amount">${{ '%.2f'|format(current_cycle_snapshot.scheduled_total) }}</p>
    <p class="muted">Scheduled this cycle</p>
    <div class="mini-rows">
      <div><span>Items</span><strong>{{ current_cycle_snapshot.occurrence_count }}</strong></div>
      <div><span>Skipped</span><strong>${{ '%.2f'|format(current_cycle_snapshot.skipped_total) }}</strong></div>
      <div><span>Remaining</span><strong>${{ '%.2f'|format(current_cycle_snapshot.remaining_total) }}</strong></div>
    </div>
  </article>

  <article class="card stat-card">
    <p class="eyebrow">Operations</p>
    <h2>System Status</h2>
    {% if schedule and app_settings %}
      <div class="mini-rows">
        <div><span>Anchor</span><strong>{{ schedule.anchor_payday_date }}</strong></div>
        <div><span>Timezone</span><strong>{{ schedule.timezone }}</strong></div>
        <div><span>Due Soon</span><strong>{{ app_settings.due_soon_days }} days</strong></div>
        <div><span>Daily Summary</span><strong>{{ app_settings.daily_summary_time }}</strong></div>
      </div>
    {% else %}
      <p class="muted">Defaults are seeded after schema exists.</p>
    {% endif %}
    <div class="inline-form" style="margin-top: .75rem;">
      <button hx-get="/api/health" hx-target="#health-result" hx-swap="innerHTML" type="button">Check health</button>
      <pre id="health-result" class="muted" aria-live="polite"></pre>
    </div>
  </article>
</section>

{% include "_interactive_panels.html" %}
{% endblock %}
